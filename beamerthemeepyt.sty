%% -*- coding: utf-8 -*-

%% epyt: a simple and nice theme for beamer
%% home: https://github.com/zohooo/epyt

\ProvidesPackage{beamerthemeepyt}[2014/04/08 v0.5]

\makeatletter

\mode<presentation>

\DeclareOptionBeamer{color}[black]{\def\beamer@epyt@color{#1}}
\ProcessOptionsBeamer

%% default theme

\usetheme{default}

%% basic settings

\setbeamersize{text margin left=1em,text margin right=1em}
%\geometry{hmargin=1em,vmargin=0em}

%% color theme

\definecolor{dgray}{HTML}{202020}
\definecolor{lgray}{HTML}{404040}
\definecolor{dblue}{HTML}{0040FF}
\definecolor{tblue}{HTML}{000099}
\definecolor{gblue}{HTML}{0033CC}
\definecolor{lblue}{HTML}{ABCDEF}
\definecolor{dred}{HTML}{660033}
\definecolor{dgreen}{HTML}{254535}
\definecolor{ggreen}{HTML}{214131}
\definecolor{lgreen}{HTML}{A9EFA9}
\definecolor{dorange}{HTML}{C07000}

\def\beamer@epyt@color@do@white{
  \setbeamertemplate{background canvas}{}
  \setbeamertemplate{background}{}
  \setbeamercolor{normal text}{bg=white,fg=black}
  \setbeamercolor{structure}{fg=blue}
  \setbeamercolor{local structure}{fg=teal}
  \setbeamercolor{footline}{bg=dblue,fg=white}
}
\def\beamer@epyt@color@do@blue{
  \setbeamertemplate{background canvas}[vertical shading][top=tblue, middle=dblue, bottom=tblue]
  \setbeamertemplate{background}[grid][step=1mm,color=gblue]
  \setbeamercolor{normal text}{bg=dblue,fg=white}
  \setbeamercolor{structure}{fg=yellow}
  \setbeamercolor{local structure}{fg=lblue}
  \setbeamercolor{footline}{bg=dred,fg=white}
  \setbeamercolor{navigation symbols}{bg=dred}
  \setbeamercolor{navigation symbols dimmed}{fg=dred}
}
\def\beamer@epyt@color@do@green{
  \setbeamercolor{background canvas}{bg=dgreen}
  \setbeamertemplate{background}[grid][step=1mm,color=ggreen]
  \setbeamercolor{normal text}{bg=dgreen, fg=white}
  \setbeamercolor{structure}{fg=yellow}
  \setbeamercolor{local structure}{fg=lgreen}
  \setbeamercolor{footline}{bg=dorange,fg=white}
  \setbeamercolor{navigation symbols}{bg=dorange}
  \setbeamercolor{navigation symbols dimmed}{fg=dorange}
}
\def\beamer@epyt@color@do@black{
  \setbeamertemplate{background canvas}[vertical shading][top=black, middle=dgray, bottom=lgray]
  \setbeamercolor{normal text}{bg=black,fg=white}
  \setbeamercolor{structure}{fg=yellow}
  \setbeamercolor{local structure}{fg=lblue}
}

\def\beamer@epyt@color@do{%
  \expandafter\let\expandafter\next
    \csname beamer@epyt@color@do@\beamer@epyt@color\endcsname
  \ifx\next\relax \let\next\beamer@epyt@color@do@black \fi
  \next
}

\beamer@epyt@color@do

\RequirePackage{xkeyval}
\define@key{epytsetup}{color}{\def\beamer@epyt@color{#1}}
\newcommand{\epytsetup}[1]{%
  \setkeys{epytsetup}{#1}%
  \beamer@epyt@color@do
}

\setbeamercolor{title}{fg=structure.fg}
\setbeamercolor{subtitle}{fg=structure.fg!90!normal text.bg}
\setbeamercolor{section in toc}{fg=structure.fg}
\setbeamercolor{subsection in toc}{fg=structure.fg!90!normal text.bg}
\setbeamercolor{frametitle}{fg=structure.fg}
\setbeamercolor{theoremname}{fg=structure.fg!90!normal text.bg}
\setbeamercolor{proofname}{fg=structure.fg!90!normal text.bg}
%\setbeamercolor{footline}{fg=normal text.fg}
%\setbeamercolor{navigation symbols}{fg=normal text.fg}
%\setbeamercolor{navigation symbols dimmed}{fg=normal text.fg}

%% font theme

\setbeamerfont{title}{size=\huge}
\setbeamerfont{subtitle}{size=\large}
\setbeamerfont{author}{size=\large}
\setbeamerfont{institute}{size=\normalsize}
\setbeamerfont{date}{size=\large}
\setbeamerfont{section in toc}{size=\Large}
\setbeamerfont{subsection in toc}{size=\large}
\setbeamerfont{frametitle}{size=\large}

\usefonttheme{professionalfonts} % there is some problem with default math fonts
%\usepackage{arev}

%% inner theme

\setbeamertemplate{itemize items}[default]
\setbeamertemplate{enumerate items}[default]

\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}{}

% sections and subsections

\AtBeginSection[]{
\begin{frame}
  \begin{center}
    \usebeamerfont{section in toc}
    \tableofcontents[sectionstyle=show/hide,subsectionstyle=hide]
  \end{center}
\end{frame}
}

\AtBeginSubsection[]{
\begin{frame}
  \begin{beamercolorbox}[wd=\paperwidth,center]{subsection in toc}%
  \usebeamerfont{subsection in toc}\insertsectionnumber.\insertsubsectionnumber\hspace*{2ex}\insertsubsection%
  \end{beamercolorbox}%
\end{frame}
}

% disable block style for theorems

\setbeamertemplate{theorem begin}
{%
  \upshape%\bfseries\inserttheoremheadfont
  {\usebeamercolor[fg]{theoremname}%
  \inserttheoremname\inserttheoremnumber
  \ifx\inserttheoremaddition\@empty\else\ (\inserttheoremaddition)\fi%
  %\inserttheorempunctuation
  }%
  \quad\normalfont
}
\setbeamertemplate{theorem end}{\par}


\setbeamertemplate{proof begin}
{%
  %\bfseries
  {\usebeamercolor[fg]{proofname}\insertproofname}%
  \quad\normalfont
}
\setbeamertemplate{proof end}{\par}

%% outer theme

\setbeamertemplate{frametitle}{\noindent\usebeamerfont{frametitle}\insertframetitle\par}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}
{
  \hbox{%
  \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,left]{footline}%
    \hspace*{1ex}\usebeamerfont{footline}\Acrobatmenu{GoToPage}{\insertframenumber{}/\inserttotalframenumber}
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.6\paperwidth,ht=2.25ex,dp=1ex,center]{footline}%
    \usebeamerfont{footline}\insertshorttitle
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,right]{footline}%
    \usebeamerfont{footline}%
    \Acrobatmenu{GoBack}{$\lhd$}\hspace*{1ex}\Acrobatmenu{GoForward}{$\rhd$}\hspace*{1ex}%
    \hyperlinkframeendprev{$\vartriangle$}\hspace*{1ex}\hyperlinkframestartnext{$\triangledown$}\hspace*{1ex}
  \end{beamercolorbox}%
  }%
}

\mode<handout>{
  \setbeamertemplate{background canvas}{}
  \setbeamertemplate{background}{}
  \setbeamercolor{normal text}{fg=black, bg=white}
  \setbeamercolor{title}{fg=blue}
  \setbeamercolor{subtitle}{fg=blue!70!gray}
  \setbeamercolor{section in toc}{fg=blue!90!gray}
  \setbeamercolor{subsection in toc}{fg=blue!80!gray}
  \setbeamercolor{frametitle}{fg=blue!70!gray}
  \setbeamercolor{theoremname}{fg=blue!60!gray}
  \setbeamercolor{proofname}{fg=blue!60!gray}
  \setbeamercolor{footline}{bg=white,fg=black}
}

\mode
<all>

\makeatother
